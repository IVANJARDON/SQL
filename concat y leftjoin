Esta serÃ­a la query para el archivo de profiles con meta, 

SELECT 

IP.AirlineCode, 
IP.DepartureDateMonth, 
IP.DepartureDateYear, 
IP.MarketLeg, 
IP.Leg, 
IP.DaysToMonthEnd, 
IP.TypeD_I, 
IP.DateMonth,
SUM(IP.PassengerCountLeg) AS PassengerCountLeg, 
SUM(IP.Capacity) AS Capacity,
SUM(IP.FareRM) AS FareRM, 
SUM(IP.FareAdminFeeRM) AS FareAdminFeeRM, 
SUM(IP.FareAdminFeeWaiverRM) AS FareAdminFeeWaiverRM, 
SUM(IP.FareWaiverRM) AS FareWaiverRM,
SUM(IP.FeeRM) AS FeeRM, 
SUM(IP.FeeWaiverRM) AS FeeWaiverRM,
SUM(IP.SurchargeRM) AS SurchargeRM,
SUM(IP.SurchargeWaiverRM) AS SurchargeWaiverRM,


BGT.Capacity as CapacityBudget, 
 BGT.Booked as BookedBudget, 
 BGT.FareAdminFee as FareAdminFeeBudget,
BGT.Fare as FareBudget, 
 BGT.Surcharge as SurchargeBudget


FROM EDW.dbo.InventoryProfile AS IP
LEFT JOIN FORECAST.dbo.BudgetSegmentINT as BGT
ON Concat(IP.DepartureDateYear,IP.DepartureDateMonth,IP.Leg)=Concat(BGT.DepartureDateYear, BGT.DepartureDateMonth,BGT.Segment)

WHERE (IP.AirlineCode='VH') AND (IP.DepartureDateYear>=2018) AND (IP.DaysToMonthEnd>=0 And IP.DaysToMonthEnd<=180) AND (IP.FlightNumber<8300 OR IP.FlightNumber>8339)
GROUP BY IP.AirlineCode, IP.DepartureDateMonth, IP.DepartureDateYear, IP.MarketLeg, IP.Leg, IP.DaysToMonthEnd, IP.TypeD_I, IP.DateMonth,
BGT.Capacity,BGT.Booked,BGT.FareAdminFee,BGT.Fare,BGT.Surcharge
Order by IP.DateMonth,IP.MarketLeg,IP.DaysToMonthEnd
